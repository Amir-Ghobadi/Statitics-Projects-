"0","library(MASS)  "
"0",""
"0",""
"0","x <- seq(from = min(xs), to = max(xs), length.out = length(xs))  "
"0","n <- rep(100, length(x))  "
"0","b0 <- -5.805e-01  "
"0","b1 <- 1.840e-02   "
"0","b2 <- -9.327e-05 "
"0","probs <- plogis(b0 + b1 * x + b2 * x^2)  "
"0",""
"0","n.sims <- 1000"
"0","xpeaks <- numeric(n.sims)  "
"0","devs <- numeric(n.sims)  "
"0",""
"0","for (i in 1:n.sims) {"
"0","    ys <- rbinom(length(x), size = n, prob = probs)"
"0",""
"0","    fit <- glm(cbind(ys, n - ys) ~ x + I(x^2), family = binomial)"
"0",""
"0","    coef_fit <- coef(fit)"
"0","    x_peak <- -coef_fit[2] / (2 * coef_fit[3])  "
"0","    xpeaks[i] <- x_peak"
"0",""
"0","    devs[i] <- deviance(fit)"
"0","}"
"0",""
"0","print(summary(xpeaks))"
"1","   Min. "
"1","1st Qu. "
"1"," Median "
"1","   Mean "
"1","3rd Qu. "
"1","   Max. "
"1","
"
"1","  72.74 "
"1","  93.83 "
"1","  98.69 "
"1","  98.58 "
"1"," 103.03 "
"1"," 132.68 "
"1","
"
"0","print(summary(devs))"
"1","     Min. "
"1","  1st Qu. "
"1","   Median "
"1","     Mean "
"1","  3rd Qu. "
"1","     Max. "
"1","
"
"1"," 0.000137 "
"1"," 0.604178 "
"1"," 1.427998 "
"1"," 2.048716 "
"1"," 2.829113 "
"1","13.010144 "
"1","
"
